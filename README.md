# ğŸš€ Build Test Project

Spring Boot ê¸°ë°˜ì˜ ë¹Œë“œ ë° ë°°í¬ ìë™í™” í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
í™˜ê²½ë³„ ì„¤ì • ë¶„ë¦¬, ìë™í™”ëœ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸, ì‹œìŠ¤í…œ ì„œë¹„ìŠ¤ ë“±ë¡ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

## ğŸ“‹ ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­
- **JDK 21** ì´ìƒ â˜•
- **Linux** í™˜ê²½ (ë°°í¬ ëŒ€ìƒ) ğŸ§

## ğŸ› ï¸ ë¹Œë“œ (Build)

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ ë°°í¬ íŒ¨í‚¤ì§€(`zip`)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### 1. ê¸°ë³¸ ë¹Œë“œ (ì „ì²´ ì„¤ì • í¬í•¨)
ëª¨ë“  í™˜ê²½(`dev`, `prod`)ì˜ ì„¤ì • íŒŒì¼ì´ í¬í•¨ëœ íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
```bash
./gradlew build
# ë˜ëŠ”
./gradlew package
```
- **ğŸ“¦ ê²°ê³¼ë¬¼**: `build/dist/build_test-{version}.dist.zip`

### 2. í™˜ê²½ë³„ ë¹Œë“œ (Prod/Dev)
íŠ¹ì • í™˜ê²½ì˜ ì„¤ì • íŒŒì¼ë§Œ í¬í•¨í•˜ì—¬ íŒ¨í‚¤ì§•í•©ë‹ˆë‹¤.
```bash
# ğŸ­ ìš´ì˜ í™˜ê²½ (Prod)
./gradlew build -Penv=prod

# ğŸš§ ê°œë°œ í™˜ê²½ (Dev)
./gradlew build -Penv=dev
```
- **ğŸ“¦ ê²°ê³¼ë¬¼**: `build/dist/build_test-{version}-{env}.dist.zip` (ì˜ˆ: `build_test-0.0.1-SNAPSHOT-prod.dist.zip`)

## ğŸš€ ë°°í¬ ë° ì„¤ì¹˜ (Deployment)

ìƒì„±ëœ `zip` íŒŒì¼ì„ ì„œë²„ë¡œ ì „ì†¡í•œ í›„, ì••ì¶•ì„ í•´ì œí•˜ê³  ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

### 1. ì„¤ì¹˜
`bin` í´ë” ë‚´ì˜ `install_service.sh`ë¥¼ **root** ê¶Œí•œìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
sudo ./install_service.sh
```

- **ğŸ“ ì„¤ì¹˜ ìœ„ì¹˜ ì§€ì •**: ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ì„¤ì¹˜í•  ê²½ë¡œë¥¼ ë¬¼ì–´ë´…ë‹ˆë‹¤. (ê¸°ë³¸ê°’: `/opt/build_test`)
    - ğŸ”„ ê¸°ì¡´ì— ì„¤ì¹˜ëœ ì„œë¹„ìŠ¤ê°€ ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ìŠ¤ë§ˆíŠ¸ ì¬ë°°í¬(ë®ì–´ì“°ê¸°)ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.
- **âš™ï¸ ì„œë¹„ìŠ¤ ë“±ë¡**: `Systemd` ë˜ëŠ” `SysVinit`ì„ ìë™ ê°ì§€í•˜ì—¬ ì„œë¹„ìŠ¤ë¥¼ ë“±ë¡í•˜ê³  ì‹œì‘í•©ë‹ˆë‹¤.
- **ğŸ“œ í¸ì˜ ìŠ¤í¬ë¦½íŠ¸**: ì„¤ì¹˜ ì‹œ `~/bin` í´ë”ì— ë¡œê·¸ í™•ì¸ ë° ìƒíƒœ ì ê²€ ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤.

### 2. ì„¤ì¹˜ í›„ ë””ë ‰í† ë¦¬ êµ¬ì¡°
ì„¤ì¹˜ ì™„ë£Œ ì‹œ ì§€ì •ëœ ê²½ë¡œ(ì˜ˆ: `/opt/build_test`)ì— ë‹¤ìŒê³¼ ê°™ì´ êµ¬ì„±ë©ë‹ˆë‹¤.
```text
/opt/build_test/
 â”œâ”€â”€ bin/
 â”‚   â”œâ”€â”€ start.sh          # â–¶ï¸ ì„œë¹„ìŠ¤ ì‹œì‘
 â”‚   â”œâ”€â”€ stop.sh           # â¹ï¸ ì„œë¹„ìŠ¤ ì¤‘ì§€
 â”‚   â””â”€â”€ status.sh         # â„¹ï¸ ìƒíƒœ í™•ì¸ (-Dapp.name ê¸°ë°˜)
 â”œâ”€â”€ config/               # ğŸ”§ ì„¤ì • íŒŒì¼ (application.yml, log4j2.yml ë“±)
 â”œâ”€â”€ libs/                 # â˜• ì‹¤í–‰ ê°€ëŠ¥í•œ JAR íŒŒì¼
 â””â”€â”€ log/                  # ğŸ“ ë¡œê·¸ íŒŒì¼ ì €ì¥ì†Œ
```

## ğŸ® ìš´ì˜ ë° ë¡œê·¸ (Operations)

### ì„œë¹„ìŠ¤ ì œì–´
ì„¤ì¹˜ëœ ì„œë¹„ìŠ¤ëŠ” `systemctl` ë˜ëŠ” `service` ëª…ë ¹ì–´ë¡œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# Systemd
sudo systemctl start build_test
sudo systemctl stop build_test
sudo systemctl restart build_test
sudo systemctl status build_test  # ë‚´ë¶€ì ìœ¼ë¡œ status.sh ì‹¤í–‰

# SysVinit
sudo service build_test start
sudo service build_test status
```

### ğŸ“ ë¡œê·¸ í™•ì¸
ì„¤ì¹˜ ì‹œ ì‚¬ìš©ì í™ˆ ë””ë ‰í† ë¦¬(`~/bin`)ì— ìƒì„±ëœ í¸ì˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.

```bash
# ì–´ë””ì„œë“  ì‹¤í–‰ ê°€ëŠ¥ (PATHì— ~/binì´ ë“±ë¡ëœ ê²½ìš°)
tail-log-build_test.sh
```
- **ë¡œê·¸ íŒŒì¼ ìœ„ì¹˜**: `/opt/build_test/log/build_test.log`

### â„¹ï¸ ìƒíƒœ í™•ì¸
ë¡œê·¸ ìŠ¤í¬ë¦½íŠ¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì–´ë””ì„œë“  ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```bash
# ì„œë¹„ìŠ¤ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì—¬ë¶€ í™•ì¸
/opt/build_test/bin/status.sh
# ë˜ëŠ” ì„œë¹„ìŠ¤ ëª…ë ¹ì–´ë¡œ í™•ì¸ (ê¶Œì¥)
sudo service build_test status
```

## ğŸ’» ê°œë°œ (Development)
- **Log4j2 ì„¤ì •**: `config/log4j2.yml`ì—ì„œ ë¡œê·¸ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
    - íŒŒì¼ëª… íŒ¨í„´: `${sys:log.path}/${sys:app.name}.log`
- **APP_NAME ì£¼ì…**: ë¹Œë“œ ì‹œ `settings.gradle`ì˜ í”„ë¡œì íŠ¸ ì´ë¦„ì´ ìŠ¤í¬ë¦½íŠ¸ì— ìë™ ì£¼ì…ë©ë‹ˆë‹¤ (`@appName@`).
- **JVM ì˜µì…˜**: `start.sh` ì‹¤í–‰ ì‹œ `-Dapp.name` ë° `-Dlog.path`ê°€ ìë™ìœ¼ë¡œ ì„¤ì •ë©ë‹ˆë‹¤.

## ğŸ¨ ìƒˆ í”„ë¡œì íŠ¸ë¡œ êµ¬ì„±í•˜ê¸° (Customization)
ì´ ì €ì¥ì†Œë¥¼ í…œí”Œë¦¿ìœ¼ë¡œ í•˜ì—¬ ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ ìˆ˜ì •í•´ì•¼ í•  ì£¼ìš” í•­ëª©ì…ë‹ˆë‹¤.

### 1. í”„ë¡œì íŠ¸ ì´ë¦„ ë³€ê²½ (í•„ìˆ˜)
`APP_NAME` ë° ë°°í¬ íŒŒì¼ëª…ì€ ì´ ì„¤ì •ì„ ë”°ë¦…ë‹ˆë‹¤.
- **íŒŒì¼**: `settings.gradle`
```groovy
rootProject.name = 'my-new-project-name' // ë³€ê²½
```

### 2. ë¹Œë“œ ì •ë³´ ìˆ˜ì •
- **íŒŒì¼**: `build.gradle`
```groovy
group = 'com.example.myteam' // íŒ¨í‚¤ì§€ ê·¸ë£¹ ë³€ê²½
version = '1.0.0'            // ì´ˆê¸° ë²„ì „ ì„¤ì •
```

### 3. íŒ¨í‚¤ì§€ëª… ë³€ê²½
- `src/main/java` í•˜ìœ„ì˜ íŒ¨í‚¤ì§€ êµ¬ì¡°(`io.github.mjyoun.build_test`)ë¥¼ ìƒˆë¡œìš´ ê·¸ë£¹ëª…ì— ë§ê²Œ ë¦¬íŒ©í† ë§í•©ë‹ˆë‹¤.

### 4. ì„¤ì • íŒŒì¼ ì´ë¦„ í™•ì¸
- `config/dev`, `config/prod` ë‚´ì˜ `application.yml`ì—ì„œ `spring.application.name`ë„ ë³€ê²½í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.

## ğŸ³ Docker ì§€ì›
Dockerë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹Œë“œí•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **Base Image**: `eclipse-temurin:21-jdk` (ì•ˆì •ì„± ë° ì„±ëŠ¥ ìµœì í™”)

### ì´ë¯¸ì§€ ë¹Œë“œ (ìë™í™” ìŠ¤í¬ë¦½íŠ¸)
í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `docker_build.sh`ë¥¼ ì‹¤í–‰í•˜ë©´ `Gradle ë¹Œë“œ` -> `Context ì¤€ë¹„` -> `Docker ë¹Œë“œ`ê°€ í•œ ë²ˆì— ìˆ˜í–‰ë©ë‹ˆë‹¤.

```bash
# ê¸°ë³¸(prod) ë¹Œë“œ
./docker_build.sh

# ê°œë°œ(dev) í™˜ê²½ ë¹Œë“œ
./docker_build.sh dev
```
- **ê²°ê³¼ ì´ë¯¸ì§€**: `build_test:latest`

### ì‹¤í–‰ (Docker Compose)
ë¡œì»¬ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ `docker-compose.yml`ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

```bash
docker-compose up -d
```
- **í¬íŠ¸**: `localhost:8080`
- **ë¡œê·¸**: `./log` í´ë”ì— ì‹¤ì‹œê°„ìœ¼ë¡œ ë¡œê·¸ê°€ ìŒ“ì…ë‹ˆë‹¤. (`tail-log` ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© ê°€ëŠ¥)

### ì‹¤í–‰ (ìˆ˜ë™)
```bash
docker run -d -p 8080:8080 \
  -v $(pwd)/log:/app/log \
  --name build_test_app \
  build_test:latest
```
